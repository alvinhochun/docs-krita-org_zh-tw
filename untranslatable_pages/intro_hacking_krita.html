

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-TW" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-TW" > <!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" name="title" content="Introduction to Hacking Krita" />
  <meta property="og:site-name" content="Krita Manual" />
  <meta property="og:type" content="article" />
  <meta property="og:locale" content="zh_TW" />
  <meta property="og:locale:alternate" content="ca" />
  <meta property="og:locale:alternate" content="en" />
  <meta property="og:locale:alternate" content="fr" />
  <meta property="og:locale:alternate" content="it" />
  <meta property="og:locale:alternate" content="ja" />
  <meta property="og:locale:alternate" content="ko" />
  <meta property="og:locale:alternate" content="nl" />
  <meta property="og:locale:alternate" content="pl" />
  <meta property="og:locale:alternate" content="pt_PT" />
  <meta property="og:locale:alternate" content="uk_UA" />
  <meta property="og:locale:alternate" content="zh_CN" />
  <meta property="og:article:modified_time" content="2021-09-16T22:09:18" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Introduction to hacking Krita." name="description" />

  
  
  <title>Introduction to Hacking Krita &mdash; Krita Manual 5.0.0 說明文件</title>
  

  
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    
  
  
  
    <link rel="canonical" href="zh_TW/untranslatable_pages/intro_hacking_krita.html"/>
    <meta property="og:url" content="zh_TW/untranslatable_pages/intro_hacking_krita.html" />
    <meta property="og:image" content="zh_TW/_static/sidebar-logo.png" />
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="The Krita Palette format KPL" href="kpl_defintion.html" />
    <link rel="prev" title="Enable static analyzer" href="enable_static_analyzer.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
       
           <a href="../index.html" class="icon icon-home">

			<img src="../_static/sidebar-logo.png" class="logo" alt="Logo"/>
           	
           <!--	Krita Manual -->


          </a>


          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜尋文件" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-side-nav-language-selector">
        	<p class="caption-text">
	        	<select id="language-selector-container">
	        		<option value="ca">Català</option>
	        		<option value="en">English</option>
	        		<option value="fr">français</option>
	        		<option value="it">Italiano</option>
	        		<option value="ja">日本語</option>
	        		<option value="ko">한국어</option>
	        		<option value="nl">Nederlands</option>
	        		<option value="pl">Polski</option>
	        		<option value="pt_PT">português</option>
	        		<option value="uk_UA">Українська</option>
	        		<option value="zh_CN">简体中文</option>
	        	</select>
        	</p>
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user_manual.html">使用者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_concepts.html">通用概念</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_manual.html">參考文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">教學及指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../KritaFAQ.html">Krita 常見問題</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../contributors_manual.html">貢獻者手冊</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../contributors_manual/community.html">Krita 的社群</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors_manual/krita_manual_conventions.html">Krita 說明文件標記格式使用慣例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors_manual/krita_manual_readme.html">Krita 說明文件貢獻指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors_manual/optimising_images.html">供說明文件使用的影像</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributors_manual/user_support.html">使用者支援入門介紹</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../untranslatable_pages.html">Technical Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="building_krita.html">Building Krita from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmake_settings_for_developers.html">CMake Settings for Developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="enable_static_analyzer.html">Enable static analyzer</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Introduction to Hacking Krita</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-started-with-kde-software">Getting started with KDE Software</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-krita">Building Krita</a></li>
<li class="toctree-l4"><a class="reference internal" href="#working-with-the-krita-codebase">Working with the Krita codebase</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-in-touch">Getting in Touch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#contributing-patches">Contributing Patches</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="kpl_defintion.html">The Krita Palette format KPL</a></li>
<li class="toctree-l3"><a class="reference internal" href="krita_svg_extensions.html">Krita SVG Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="modern_cpp_in_krita.html">Modern C++ usage guidelines for the Krita codebase</a></li>
<li class="toctree-l3"><a class="reference internal" href="new_features.html">Developing Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimizing_tips_for_krita.html">Optimizing tips and tools for Krita</a></li>
<li class="toctree-l3"><a class="reference internal" href="participating_in_gsoc.html">Google Summer of Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="patch_review_guide.html">Advanced Merge Request Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_coding.html">Python Developer Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="quality_assurance.html">Introduction to Quality Assurance</a></li>
<li class="toctree-l3"><a class="reference internal" href="release_krita.html">Making a release</a></li>
<li class="toctree-l3"><a class="reference internal" href="reporting_bugs.html">Reporting Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_krita.html">Running Krita from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="strokes_documentation.html">Strokes queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="strokes_documentation.html#strokes-public-api">Strokes public API</a></li>
<li class="toctree-l3"><a class="reference internal" href="strokes_documentation.html#internals-of-the-freehand-tool">Internals of the freehand tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="strokes_documentation.html#scheduled-undo-redo">Scheduled Undo/Redo</a></li>
<li class="toctree-l3"><a class="reference internal" href="strokes_documentation.html#processings-framework">Processings framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing_strategy.html">Testing Strategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="triaging_bugs.html">Triaging Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="unit_tests_in_krita.html">Unittests in Krita</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../resources_page.html">資源</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

	<!-- start top banner area (for fundraisers or messages)

	<div style="text-align: center; background-color: #333">
		<a href="https://krita.org/en/fundraising-2018-campaign/" target="_self" onclick="ga('send', 'event', 'frontpage', 'button', 'Fundraiser 2018');">
			<img src="https://krita.org/wp-content/themes/krita-org-theme/images/decoration/2018-fundraiser-banner.png" style="max-width: 100%">
		</a>
	</div>
	
	 end top banner area -->

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Krita Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">文件</a> &raquo;</li>
        
          <li><a href="../contributors_manual.html">貢獻者手冊</a> &raquo;</li>
        
          <li><a href="../untranslatable_pages.html">Technical Pages</a> &raquo;</li>
        
      <li>Introduction to Hacking Krita</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
          
            <a href="../_sources/untranslatable_pages/intro_hacking_krita.rst.txt" rel="nofollow"> 
             
              <img src="../_static/images/source-code.png" />
             <!-- 檢視頁面原始碼 -->

          </a>
          
        
      </li>
    
  </ul>

  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="introduction-to-hacking-krita">
<span id="intro-hacking-krita"></span><h1><a class="toc-backref" href="#id2">Introduction to Hacking Krita</a><a class="headerlink" href="#introduction-to-hacking-krita" title="本標題的永久連結">¶</a></h1>
<div class="contents topic" id="id1">
<p class="topic-title">目錄</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction-to-hacking-krita" id="id2">Introduction to Hacking Krita</a></p>
<ul>
<li><p><a class="reference internal" href="#getting-started-with-kde-software" id="id3">Getting started with KDE Software</a></p></li>
<li><p><a class="reference internal" href="#getting-started" id="id4">Getting Started</a></p></li>
<li><p><a class="reference internal" href="#building-krita" id="id5">Building Krita</a></p></li>
<li><p><a class="reference internal" href="#working-with-the-krita-codebase" id="id6">Working with the Krita codebase</a></p>
<ul>
<li><p><a class="reference internal" href="#debugging" id="id7">Debugging</a></p></li>
<li><p><a class="reference internal" href="#tips-when-tackling-issues" id="id8">Tips when Tackling Issues</a></p></li>
<li><p><a class="reference internal" href="#calligra-and-krita" id="id9">Calligra and Krita</a></p></li>
<li><p><a class="reference internal" href="#style-guidelines" id="id10">Style guidelines</a></p></li>
<li><p><a class="reference internal" href="#development-philosophy" id="id11">Development Philosophy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#getting-in-touch" id="id12">Getting in Touch</a></p></li>
<li><p><a class="reference internal" href="#contributing-patches" id="id13">Contributing Patches</a></p>
<ul>
<li><p><a class="reference internal" href="#forking-on-gitlab" id="id14">Forking on Gitlab</a></p></li>
<li><p><a class="reference internal" href="#update-the-master-branch-in-your-fork" id="id15">Update the master branch in your fork</a></p></li>
<li><p><a class="reference internal" href="#label-workflow" id="id16">Label workflow</a></p></li>
<li><p><a class="reference internal" href="#how-to-prepare-your-commits-for-a-merge-request" id="id17">How to prepare your commits for a merge request</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="getting-started-with-kde-software">
<h2><a class="toc-backref" href="#id3">Getting started with KDE Software</a><a class="headerlink" href="#getting-started-with-kde-software" title="本標題的永久連結">¶</a></h2>
<p>Krita is a great place to start even if you are brand new to KDE development. We'd love to have you join! You'll be able to work on one of the coolest and fastest-growing open source painting programs out there. Krita also benefits from a modular architecture and the use of the KDE Frameworks and Qt libraries, which makes it easier to focus on new features instead of reinventing the wheel. And it makes coding fun! To work on Krita, you have to use C++ and Qt. It's a good way to learn both, actually!</p>
<p>KDE has undergone big changes since a major <a class="reference external" href="https://www.kde.org/announcements/kde-frameworks-5.0.php">2014 reorganization</a>. As a result, working with KDE software has never been easier.  Unfortunately, since the changes were so widespread, the documentation has not caught up at all.  If you are embarking on this journey, it would be very generous to share your discoveries with others and update pages.  (=</p>
</section>
<section id="getting-started">
<h2><a class="toc-backref" href="#id4">Getting Started</a><a class="headerlink" href="#getting-started" title="本標題的永久連結">¶</a></h2>
<p>Here's some links to get your started.</p>
<ol class="arabic">
<li><p>Most important, the <a class="reference external" href="https://invent.kde.org/graphics/krita.git">repository</a>. There is a <a class="reference external" href="https://github.com/KDE/krita">mirror on Github</a>, however note that we do not use Github for development, do not create pull requests or file issues on github.</p></li>
<li><p>KDE Developer wiki - The KDE Techbase Wiki has instructions for new developers.  On top of basic tools like C++, git, and general notions such as building software libraries, some special tools that are particular to Krita are Qt, CMake, and KDE Frameworks.  It can be very helpful to get started by finding some of the articles discussing these tools and reading up. Here are some of the more useful pages to get you started:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://techbase.kde.org/Development">https://techbase.kde.org/Development</a></p></li>
<li><p><a class="reference external" href="https://techbase.kde.org/Contribute">https://techbase.kde.org/Contribute</a></p></li>
<li><p><a class="reference external" href="https://techbase.kde.org/Development/Git/Configuration">https://techbase.kde.org/Development/Git/Configuration</a></p></li>
<li><p><a class="reference external" href="https://techbase.kde.org/Development/Tutorials">https://techbase.kde.org/Development/Tutorials</a></p></li>
<li><p><a class="reference external" href="https://booki.flossmanuals.net/kde-guide/">https://booki.flossmanuals.net/kde-guide/</a></p></li>
<li><p><a class="reference external" href="https://doc.qt.io/">https://doc.qt.io/</a> Qt has some of the best documentation of any software library.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Set up your development environment and build Krita!</p></li>
<li><p>Find a few bugs to fix in <a class="reference external" href="https://bugs.kde.org/">KDE's Bugtracking system</a>. It's often a good idea to get some experience with the code through fixing bugs, to get familiar with the development process without being overwhelmed. Though there's nothing against working on that cool feature that scratches your itch!</p></li>
<li><p>If you intend to be a regular contributor to Krita, even just for bugreports and feature discussion, the first thing you will want to do is register for a <a class="reference external" href="https://identity.kde.org/">KDE Identity account</a>.  This serves as your mostly-universal login to KDE code repositories and websites.</p></li>
</ol>
</section>
<section id="building-krita">
<h2><a class="toc-backref" href="#id5">Building Krita</a><a class="headerlink" href="#building-krita" title="本標題的永久連結">¶</a></h2>
<img alt="../_images/Krita-building_for-cats_intro_by-deevad.jpg" src="../_images/Krita-building_for-cats_intro_by-deevad.jpg" />
<p>To get started, all you need to do is get a copy of Krita and build it! This is not all that much different from building something off GitHub... except that Krita is very large compared to most software.  There are <a class="reference internal" href="building_krita.html#building-krita"><span class="std std-ref">build guides</span></a> to get you going on various platforms, but of course Linux is easiest.</p>
</section>
<section id="working-with-the-krita-codebase">
<h2><a class="toc-backref" href="#id6">Working with the Krita codebase</a><a class="headerlink" href="#working-with-the-krita-codebase" title="本標題的永久連結">¶</a></h2>
<p>Here's some pointers for working with our codebase.</p>
<dl>
<dt>Architecture</dt><dd><p>The code base changes all the time with Krita, we're not afraid of big refactorings, so there is no up to date documentation on the code architecture. There have been some written in the past, but they quickly became outdated and of little use. There is a fairly up to date <a class="reference external" href="https://api.kde.org/appscomplete-api/krita-apidocs/">API guide</a> if you want to look at how the code is structured.</p>
</dd>
<dt>Integrated Development Environment (IDE)</dt><dd><p>The most popular IDEs that we use are Qt Creator, Emacs, KDevelop, or vim. Qt Creator has the advantage of the ctrl-k menu, which lets you leap to classes, lines, everywhere. You don't have to build with Qt Creator though! It can be easier to jump to the terminal, do a 'make', check what's up, and then jump back to the IDE.</p>
</dd>
<dt>Resources</dt><dd><p>The most important step to learning the code is to really understand memory management: pointers, smart pointers and pointer arithmetic. This is something that Java and C# developers will need to spend a little more time understanding. Here are a couple resources to get you more familiar with C++ and Qt:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://doc.qt.io/archives/qt-4.8/how-to-learn-qt.html">Qt Concepts</a></p></li>
<li><p><a class="reference external" href="https://www.ics.com/designpatterns/book/index.html">Design Patterns with Qt</a></p></li>
<li><p>C++ in a Nutshell by O'Reilly (book)</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<section id="debugging">
<h3><a class="toc-backref" href="#id7">Debugging</a><a class="headerlink" href="#debugging" title="本標題的永久連結">¶</a></h3>
<p>There are large and small problems. For small problems the debugger in Qt Creator (run external application) or adding qDebug messages to the code is fine. If the problem is difficult, the first step should always be to write a unit test. A small bit of code that follows a set pattern and exercises the faulty code and shows the problem. That helps so much figuring out a fix and keeping it fixed.</p>
<p>When you run a debug build of Krita, you may be surprised how little debug output you see. This is because most of Krita's debugging information is turned off by default.  The debug statements are grouped into categories such as <code class="docutils literal notranslate"><span class="pre">dbgUI</span></code>, <code class="docutils literal notranslate"><span class="pre">dbgKrita</span></code> and so on.  The output categories are controlled by an environment variable <code class="docutils literal notranslate"><span class="pre">QT_LOGGING_RULES</span></code>.</p>
<p>The list of Krita's debug categories is contained in <code class="docutils literal notranslate"><span class="pre">kis_debug.h</span></code> and <code class="docutils literal notranslate"><span class="pre">main.cc</span></code>, and the rules for the environment variable are described in the <a class="reference external" href="https://doc.qt.io/qt-5/qloggingcategory.html">Qt reference for QLoggingCategory</a>.</p>
<p>As an example, to enable most of Krita's debug output, you can run the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">QT_LOGGING_RULES=&quot;krita*=true&quot;;</span> <span class="pre">krita</span></code></p>
<p>Using the rule <code class="docutils literal notranslate"><span class="pre">*=true</span></code> will produce a firehose, if you want it.</p>
</section>
<section id="tips-when-tackling-issues">
<h3><a class="toc-backref" href="#id8">Tips when Tackling Issues</a><a class="headerlink" href="#tips-when-tackling-issues" title="本標題的永久連結">¶</a></h3>
<dl class="simple">
<dt>Features and Refactorings</dt><dd><p>Sometimes you just know that a lot of work is going to be needed to reach a particular goal. These will go in separate feature branches off 'master'.</p>
</dd>
<dt>Performance Improvements</dt><dd><p>Sometimes you don't feel like working on a feature -- or someone mentioned something being particularly slow. The first thing to do then is carry out that scenario when Krita runs under <a class="reference external" href="http://c.learncodethehardway.org/book/ex41.html">callgrind</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/VTune">vtune</a>. These tools show bottlenecks at the end of a run. It's important to use both, since both give different insights!</p>
</dd>
<dt>Bugs</dt><dd><p>Sometimes you rummage around the bugs on b.k.o to see what looks like a nice Saturday morning fix. Sometimes a bug is really urgent (like all data loss bugs). Sometimes someone on IRC or the forum mentions a bug. The first thing to do is reproduce it. The second thing is to look in the code to see what is going on. If it's a crash bug, especially one that seems mysterious, it might help to google for a few of the key lines in the backtrace. Sometimes it's a distribution issue!</p>
</dd>
<dt>Blockers</dt><dd><p>If you are helping with Krita and your progress is being blocked by something - let us know! Talk with us on the <a class="reference external" href="https://krita.org/irc/">Krita developer IRC</a> and we will see what we can do to help!</p>
</dd>
</dl>
</section>
<section id="calligra-and-krita">
<h3><a class="toc-backref" href="#id9">Calligra and Krita</a><a class="headerlink" href="#calligra-and-krita" title="本標題的永久連結">¶</a></h3>
<p>In October 2015, the Krita project separated from the rest of the Calligra office suite.  The new repository still clearly contains this history. Most source code files will have one of two prefixes. &quot;Ko&quot; stands for KOffice, the original name of Calligra office suite.  These files mostly comprise basic, lower-level libraries.  &quot;Kis&quot; stands for KImageShop, the original name of Krita. These files are where most of the painting-specific functionality is maintained.</p>
<p>Krita 2.9 stable is built from the Calligra repo.  Krita 3.x and above is built from the Krita repo.</p>
</section>
<section id="style-guidelines">
<h3><a class="toc-backref" href="#id10">Style guidelines</a><a class="headerlink" href="#style-guidelines" title="本標題的永久連結">¶</a></h3>
<p>See <code class="docutils literal notranslate"><span class="pre">HACKING</span></code> in the codebase.</p>
</section>
<section id="development-philosophy">
<h3><a class="toc-backref" href="#id11">Development Philosophy</a><a class="headerlink" href="#development-philosophy" title="本標題的永久連結">¶</a></h3>
<p>Krita is nearly ten years old, consists of something like a million lines of code, and has had many individual contributors throughout the years. If you run into something in the code that doesn't make sense to you, it may very well not make sense to anyone.  Developing a codebase this large is an art form, you should feel confident in making risky changes even if you're not sure they'll work, you can always go back with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">--</span> <span class="pre">*</span></code> if you mess it up!</p>
</section>
</section>
<section id="getting-in-touch">
<h2><a class="toc-backref" href="#id12">Getting in Touch</a><a class="headerlink" href="#getting-in-touch" title="本標題的永久連結">¶</a></h2>
<p>If you're working on a bug fix, or maybe a bit of GUI polish, you might get stumped. The best thing to do then is to get in touch with the rest of the Krita team. Part of the fun of working on an open source application is the community, after all! Join us on <code class="docutils literal notranslate"><span class="pre">#krita</span> <span class="pre">on</span> <span class="pre">Libera.Chat</span></code> (keep in mind that most people are in Europe or India) and just ask your question. Stay around, especially if you don't get an answer immediately. Some of the developers have their irc client open permanently and will often answer questions hours later!</p>
<p>You can also send mail to the mailinglist: <code class="docutils literal notranslate"><span class="pre">kimageshop&#64;kde.org</span></code>. It's better not to send mail to individual developers directly, you might accidentally pick someone who hasn't got the answer, and miss the chance of getting your question answered by another Krita developer.</p>
</section>
<section id="contributing-patches">
<h2><a class="toc-backref" href="#id13">Contributing Patches</a><a class="headerlink" href="#contributing-patches" title="本標題的永久連結">¶</a></h2>
<p>Patch review and development tracking happens on <a class="reference external" href="https://invent.kde.org">gitlab</a>. To log in, enter your KDE Identity in the LDAP login field. You can join the <a class="reference external" href="https://phabricator.kde.org/project/profile/8/">Krita: Next</a>. If you are used to Github, <a class="reference external" href="https://invent.kde.org/help/#new-to-git-and-gitlab">the transition to gitlab is not difficult</a>, but it is slightly different.</p>
<p>To push to invent.kde.org, you will not need to have SSH access setup, but you do KDE identity account. If several of your merge requests are accepted, you can get a commiter's account, which will allow you to push directly to the repositories.  You can read more about that here: <a class="reference external" href="https://community.kde.org/Infrastructure/Get_a_Developer_Account">Getting a developer account</a></p>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>Since moving to the gitlab instance, we don't use <code class="docutils literal notranslate"><span class="pre">git&#64;git.kde.org:krita</span></code> but rather <code class="docutils literal notranslate"><span class="pre">git&#64;invent.kde.org:graphics/krita</span></code>. Gitlab will not be able to see your commits if you push to the former. You can use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">set-url</span> <span class="pre">origin</span> <span class="pre">git&#64;invent.kde.org:graphics/krita</span></code> to get everything pointing correctly.</p>
</div>
<p>So then, how does an aspiring contributor submit patches?</p>
<section id="forking-on-gitlab">
<span id="forking-gitlab"></span><h3><a class="toc-backref" href="#id14">Forking on Gitlab</a><a class="headerlink" href="#forking-on-gitlab" title="本標題的永久連結">¶</a></h3>
<ol class="arabic simple">
<li><p>Forking on gitlab is done by going to the <a class="reference external" href="https://invent.kde.org/graphics/krita.git">repository</a> and pressing <span class="guilabel">fork</span>. You will then make a personal fork of the repository.</p></li>
</ol>
<p>Your fork will probably be located here:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">invent</span><span class="o">.</span><span class="n">kde</span><span class="o">.</span><span class="n">org</span><span class="o">/&lt;</span><span class="n">username</span><span class="o">&gt;/</span><span class="n">krita</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic">
<li><p>In your fork, you press <span class="guilabel">clone</span> to get the git urls to do the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> from. You can then pull and push your commits from these.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># for ssh access</span>
git clone git@invent.kde.org:&lt;username&gt;/krita.git
<span class="c1"># for https access</span>
git clone https://invent.kde.org/&lt;username&gt;/krita.git
</pre></div>
</div>
<p>You can also use the <span class="guilabel">Web IDE</span> to make your changes directly on invent.kde.org, but because Krita is a c++ program, we don't recommend this outside of typo fixes and doxygen documentation strings. You wouldn't be able to see the effect of your changes, after all!</p>
</div></blockquote>
</li>
<li><p>Set up a new remote which points to the official repository, so you'll be able to update your local master branch.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># for ssh access</span>
git remote add upstream git@invent.kde.org:graphics/krita.git
<span class="c1"># for https access</span>
git remote add upstream https://invent.kde.org/graphics/krita.git
</pre></div>
</div>
<p>After that, you can see all of your urls using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git remote --verbose
</pre></div>
</div>
<p>As you can see, <cite>origin</cite> points to your fork, while <cite>upstream</cite> points to the official repository.</p>
</div></blockquote>
</li>
<li><p>Create a new branch and checkout to it.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout -b <span class="s2">&quot;&lt;username&gt;/&lt;description of the new feature&gt;&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Make your first fix, push everything to your branch in your fork.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># make sure you didn&#39;t leave any unnecessary debug or unfinished code</span>
git diff
<span class="c1"># stage all changes</span>
git add .
<span class="c1"># make sure that all added files are the ones you want to have in your commit</span>
git status
<span class="c1"># commit changes (here, write a commit messages that follows the rules)</span>
git commit
<span class="c1"># push to your branch</span>
git push
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>Make sure all of your commits go to your own branch, not onto master.</p>
</div>
</div></blockquote>
</li>
<li><p>Once you're done, login to the KDE gitlab instance, go to <span class="menuselection">merge requests</span> and press <span class="guilabel">new merge request</span></p></li>
<li><p>Make sure your merge request is between the branch from your fork and the official master branch.</p></li>
<li><p>Write a detailed description about the changes that you are proposing with your merge request. If it is a change in the user interface, it would be good if you can provide screenshots through attachments.</p>
<blockquote>
<div><div class="admonition tip">
<p class="admonition-title">小訣竅</p>
<p>The Krita repository has a merge request template that labels your request appropriately and gives a checklist of common formalities that all patches should adhere to. You can select it from the <span class="guilabel">Template</span> drop down.</p>
</div>
</div></blockquote>
</li>
</ol>
<p>The Krita developers will be notified of new merge requests, and they will try to review your request as soon as possible. If you suspect your patch slipped through the cracks, don't hesitate to contact us through the means described above.</p>
</section>
<section id="update-the-master-branch-in-your-fork">
<h3><a class="toc-backref" href="#id15">Update the master branch in your fork</a><a class="headerlink" href="#update-the-master-branch-in-your-fork" title="本標題的永久連結">¶</a></h3>
<p>After working for some time, you may want to update the master branch of your fork to be in sync with the master branch of the official repository.</p>
<ol class="arabic">
<li><p>Checkout the master branch in your working environment.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout master
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Pull changes from the official repository.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git pull --ff-only upstream master
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Push it to your fork.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push
</pre></div>
</div>
<p>The other possibility is to just delete the fork you worked previously on and create another one -- it will be up-to-date with official repository's master branch already.</p>
</div></blockquote>
</li>
</ol>
</section>
<section id="label-workflow">
<h3><a class="toc-backref" href="#id16">Label workflow</a><a class="headerlink" href="#label-workflow" title="本標題的永久連結">¶</a></h3>
<p>Make sure the state of your merge request is labeled correctly. The picture below shows the basic label workflow that your merge request should go through:</p>
<a class="reference internal image-reference" href="../_images/Merge_Request_Label_Workflow.png"><img alt="../_images/Merge_Request_Label_Workflow.png" src="../_images/Merge_Request_Label_Workflow.png" style="width: 1000px;" /></a>
<ol class="arabic">
<li><p>When you create a merge request, mark it with WIP to make sure no one will accidentally merge your request prematurely.</p></li>
<li><p>When you finish your work, label it with <code class="docutils literal notranslate"><span class="pre">Needs</span> <span class="pre">Review</span></code>. That will let developers know your merge request is ready.</p></li>
<li><p>A Krita developer will read and test your merge request. After that they will write comments and label the merge request accordingly:</p>
<blockquote>
<div><ul class="simple">
<li><p>If the merge request is ready to be merged, with <code class="docutils literal notranslate"><span class="pre">Approved</span></code> label.</p></li>
<li><p>If it requires changes to proceed, with <code class="docutils literal notranslate"><span class="pre">Needs</span> <span class="pre">Changes</span></code> label.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>If your merge request is in <code class="docutils literal notranslate"><span class="pre">Needs</span> <span class="pre">Changes</span></code> state, please address the concerns of the reviewer and submit the code to your branch. Gitlab will update your merge request accordingly. Add <code class="docutils literal notranslate"><span class="pre">Needs</span> <span class="pre">Review</span></code> label to your MR again.</p></li>
<li><p>When your merge request is in the <code class="docutils literal notranslate"><span class="pre">Approved</span></code> state, you can either merge the code yourself to master if you have developer access, or wait for KDE developer to do it for you.</p>
<blockquote>
<div><div class="admonition attention">
<p class="admonition-title">注意</p>
<p>If you have developer access and merge someone's merge request to the repository, you are partially responsible for the code.</p>
<ul class="simple">
<li><p>Don't merge MRs that weren't approved!</p></li>
<li><p>Read and test extensively all MRs before you approve or merge!</p></li>
</ul>
</div>
</div></blockquote>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>In time of writing, setting labels on merge requests were only possible by contributors with write access to the official repository. (If you don't know what that means, that probably means you're not one of them). Because of that, when you create or change your merge request you need you get on IRC (see <a class="reference internal" href="../contributors_manual/community.html#the-krita-community"><span class="std std-ref">Krita 的社群</span></a>) and ask someone to label it for you.</p>
</div>
</section>
<section id="how-to-prepare-your-commits-for-a-merge-request">
<h3><a class="toc-backref" href="#id17">How to prepare your commits for a merge request</a><a class="headerlink" href="#how-to-prepare-your-commits-for-a-merge-request" title="本標題的永久連結">¶</a></h3>
<p>After merging to master, your commits should fit nicely in the Krita git history.</p>
<ul>
<li><p>Commit messages should clearly and concisely state what changes you made with that particular commit and why -- see <a class="reference external" href="https://chris.beams.io/posts/git-commit/">How to Write a Git Commit Message</a>.</p></li>
<li><p>Every commit should be compilable and follow the KDE commit guidelines -- see <a class="reference external" href="https://community.kde.org/Policies/Commit_Policy">KDE Commit Policy</a>.</p></li>
<li><p>Commits should be self-contained: if you code a bigger feature, it's better if you divide the code into bits that can possibly exist independently.</p></li>
<li><p>When you add new features during the development, it's fine to add new commits.</p></li>
<li><p>If you only need to fix previous commits, don't add new ones -- instead, amend the ones that you made before and force-push your new commits to the branch in your fork.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you already committed your changes...</span>
git commit
<span class="c1"># ...add all changed files the &quot;staged&quot; state</span>
git add .
<span class="c1"># and amend the previous commit</span>
git commit --amend
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>You can only force-push to your own branch on your own fork. If you need to remove changes from one of the commits that are already in the official repository, please use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code>.</p>
</div>
</div></blockquote>
</li>
<li><p>When you want to reduce the number of commits:</p>
<blockquote>
<div><ul class="simple">
<li><p>you can squash them before making a merge request.</p></li>
<li><p>if you have developer access, you can squash the commits just before merging with master.</p></li>
<li><p>See the <a class="reference external" href="https://github.com/servo/servo/wiki/Beginner's-guide-to-rebasing-and-squashing#squashing">Beginner's guide to rebasing and squashing</a> for further guidance.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Your work should go to a new branch, instead of master.</p></li>
<li><p>Your commits will be rebased and put in master using fast-forward merge. If you need a manual merge (if, for example, you're working on a big feature) and you don't have the commit access, please contact a Krita developer.</p></li>
</ul>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="kpl_defintion.html" class="btn btn-neutral float-right" title="The Krita Palette format KPL" accesskey="n" rel="next"> <!-- 下一個 --> <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="enable_static_analyzer.html" class="btn btn-neutral" title="Enable static analyzer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> <!-- 上一個  -->  </a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版權所有 licensed under the GNU Free Documentation License 1.3+ unless stated otherwise。
      
        <span class="commit">
          修訂版本 <code>bc03e95</code>
        </span>
      

    </p>
  </div>
  使用 <a href="http://sphinx-doc.org/">Sphinx</a> 以及經修改過的 <a href="https://github.com/rtfd/sphinx_rtd_theme">RTD 主題</a>建置<br/>
  <a href="https://krita.org" title="Krita 官方網站">Krita 官方網站</a> |
  <a href="https://invent.kde.org/documentation/docs-krita-org/" title="這份手冊的 KDE GitLab 專案網址">docs.krita.org 的 Git 原始碼儲存庫</a> |
  <a href="https://www.kde.org/community/whatiskde/impressum-en.php" title="了解更多關於 KDE、code of conduct（行為準則）、隱私政策及 GDPR（一般資料保護規則）">KDE Impressum</a>
   

</footer>

        </div>
      </div>

    </section>

  </div>
  

  
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
      <script src="../_static/jquery.js"></script>
      <script src="../_static/underscore.js"></script>
      <script src="../_static/doctools.js"></script>
      <script src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

 <script type="text/javascript">
	 var _paq=_paq||[];
	 _paq.push(['setCookieDomain','*.krita.org']);
	 _paq.push(['setDomains','*.krita.org']);
	 _paq.push(['setDocumentTitle',document.domain+"/"+document.title]);
	 _paq.push(['trackPageView']);
	 _paq.push(['enableLinkTracking']);

	 (function(){
	 	var u="//stats.kde.org/";
	    _paq.push(['setTrackerUrl',u+'piwik.php']);
	    _paq.push(['setSiteId',13]);
	    var d = document, g = d.createElement('script'),s=d.getElementsByTagName('script')[0];
	    g.type = 'text/javascript';
	    g.async = true;
	    g.defer = true;
	    g.src = u+'piwik.js';
	    s.parentNode.insertBefore(g,s);
	  })();
</script> 
<noscript><p><img src="//stats.kde.org/piwik.php?idsite=13" style="border:0;" alt="" /></p></noscript>

</body>
</html>